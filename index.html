<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <title>Data-driven modelling and calibration of multi-agent systems</title>

    <meta name="description" content="Data-driven modelling">
    <meta name="author" content="Andrea Mortaro">

    <!-- <link rel="stylesheet" href="dist/reset.css"> -->
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/white.css" id="theme">

		<!-- Theme used for syntax highlighted code 
		<link rel="stylesheet" href="plugin/highlight/monokai.css" id="highlight-theme">
-->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>


	</head>
	<body>
		<div class="reveal">
			<div class="slides">

	<section>
	  <p>
        <b>Università degli Studi di Verona</b><br>
            DEPARTMENT OF COMPUTER SCIENCE
	  </p>
	  <p style="font-size:30px;">
	    Master Degree in Mathematics <br>
	  </p>
	  <h4>Data-driven modelling and calibration of multi-agent systems</h4>

	  <table style="width:80%; frameborder=1; font-size:20px;">
	    <tr >
	      <td style="width:50%;">Candidate:<br>
		Andrea Mortaro
	      </td>
	      <td>Supervisor:<br>
			Prof. Dott. Giacomo Albi<br>
	      </td>
	    </tr>
	  </table>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade">
	  <h3>Introduction</h3>
	  <p style="font-size:25px;">
        Our aim is to study interaction dynamics and model them using data-driven techniques in a traffic context.
        The emphasis of this thesis is on:
	  </p>
	  <ul style="font-size:25px;">
	    <li>Discrete-to-continuum transition in traffic modelling.</li>
	    <li>Neural networks for modelling interactions with data.</li>
	  </ul>
	</section>




	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
	  <h3>Traffic models</h3>
    </section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
	  <h3>Traffic models</h3>
	  <p style="text-align:left; font-size:25px;">
	    Our focus lies in uncovering the underlying connection in traffic modelling between:
	  </p>
	  <ul style="font-size:25px;">
	    <li><b><i>Macroscopic models</i></b>, as the <i>Lighthill–Whitham–Richards (LWR) model</i>;</li>
	    <li><b><i>Microscopic models</i></b>, as the <i>Follow-The-Leader</i>-type <i>(FTL)</i> models.</li>
	  </ul>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>
	  <h5>Macroscopic models</h5>

	</section>

	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>
	  <h5>Macroscopic models</h5>
	  
	  \[
\rho_{t} + \left( f(\rho) \right)_{x} = 0, \quad t>0,\, x \in \mathbb{R},
	  \]

	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>
	  <h5>Microscopic models</h5>

	</section>

	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>
	  <h5>Microscopic models</h5>
	  
	  \[
	  
\left\{
    \begin{aligned}
      & \dot{x}_{n} = v_{max} \\
      & \dot{x}_{i} = v \left( \dfrac{ \ell }{ x_{i+1} - x_{i} } \right), \quad &&i = 1,... , n-1
    \end{aligned}
\right.
	  
	  \]

	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

    IMMAGINE QUALITATIVA?

	</section>



	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>
	  <h5>Theoretical analysis</h5>

	</section>

	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>
	  <h5>Theoretical analysis</h5>

\begin{equation}
\label{cauchy}
\left\{
    \begin{aligned}
        & \rho_{t} + \left(f(\rho)\right)_{x} = 0, \quad &&(t,x) \in (0, +\infty) \times \mathbb{R}, \\
        & \rho(0,x) = \bar{\rho}(x) \quad &&x \in \mathbb{R},
    \end{aligned}
\right.
\end{equation}

        <p style="text-align:left; font-size:30px;">
        where $f(\rho)\ \dot{=}\ \rho\ v(\rho)$.
        </p>
        
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>
	  <h5>Theoretical analysis</h5>

      <p style="text-align:left; font-size:25px;">
  	  The main properties of the solutions of the Cauchy problem are:	  
      	  <ul style="text-align:left; font-size:25px;">
	            <li>if $\bar{\rho}$ has compact support $\implies$ the support of any solution has a finite speed of propagation;</li>
	            <li>The Maximum Principle holds true;</li>
	            <li>if $\bar{\rho}(x) \geq 0 \implies \rho(x) \geq 0 \quad \forall t >0$;</li>
	            <li>The total mass $\int_{\mathbb{R}} \rho(t, x)\, dx$ is time independent:
	            \[
              \int_{\mathbb{R}} \rho(t, x)\, dx = L\ \dot{=} \int_{\mathbb{R}} \bar{\rho}(x)\, dx \quad  \forall t \geq 0.
	            
	            \]
	            </li>
	      </ul>
      </p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>
	  <h5>Theoretical analysis</h5>

<p style="text-align:left; font-size:25px;">	  

Assume that $\bar{\rho}$ and $v:\mathbb{R}_{+}\rightarrow\mathbb{R}$ satisfy:   

\begin{equation} \label{hp:rho} 
\bar{\rho} \in \mathcal{L}^\infty(\mathbb{R}) \cap \mathcal{L}^1(\mathbb{R}),\quad \bar{\rho} \geq 0,
\end{equation}

\begin{equation} \label{hp:v}
v \in \mathcal{C}^1(\mathbb{R}_{+}),\quad v'(\rho) < 0\ for\ \rho > 0.
\end{equation}

</p>

	</section>

	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>
	  <h5>Theoretical analysis</h5>

<p style="text-align:left; font-size:25px;">	  

Assume that $\bar{\rho}$ and $v:\mathbb{R}_{+}\rightarrow\mathbb{R}$ satisfy:   

\begin{equation*} 
\bar{\rho} \in \mathcal{L}^\infty(\mathbb{R}) \cap \mathcal{L}^1(\mathbb{R}),\quad \bar{\rho} \geq 0,
\end{equation*}

\begin{equation*}
v \in \mathcal{C}^1(\mathbb{R}_{+}),\quad v'(\rho) < 0\;\; \forall\rho > 0.
\end{equation*}

In some cases we require the additional assumptions:

\begin{equation} \label{addhp:rho}
\bar{\rho} \in \mathcal{BV}(\mathbb{R}),
\end{equation}

\begin{equation} \label{addhp:v}
\mathbb{R}^{+} \ni \rho \mapsto \rho\ v'(\rho) \in \mathbb{R}^{-}
\end{equation}

</p>

	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>
	  <h5>Theoretical analysis</h5>

      <p style="text-align:left; font-size:25px;">
      
For sake of simplicity, we assume:   

\begin{equation*} 
L\ \dot{=}\|\bar{\rho}\|_{\mathcal{L}^1(\mathbb{R})} = 1
\end{equation*}

\begin{equation*} 
v_{\text{max}}\ \dot{=}\ v(0),\quad v_{\text{max}} > 0
\end{equation*}

      </p>

	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>
	  <h5>Theoretical analysis</h5>

<p style="text-align:left;font-size:25px;">
   	  
<b>Definition 1</b> (Entropy solution).
<i>Let the initial datum $\bar{\rho}$ satisfy \eqref{hp:rho}. A weak solution $\rho \in \mathcal{L}^\infty(\mathbb{R})$ to the Cauchy problem \eqref{cauchy} is called <b>entropy solution</b> to the Cauchy problem if:

\begin{equation*}
\iint\limits_{\mathbb{R}^+ \times \mathbb{R}}
\bigg[ |\rho(t,x) - k|\varphi_{t}(t,x)\ +\ \text{sign}(\rho(t,x) - k) \left[ f(\rho(t,x)) - f(k)\right]\varphi_{x}(t,x)\bigg] dx\ dt\ \geq 0
\end{equation*}

for all $\varphi \in \mathcal{C}_{c}^\infty((0, +\infty) \times \mathbb{R})$ and for all $k \geq 0$.</i>

</p>

	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>
	  <h5>Theoretical analysis</h5>

<p style="text-align:left;font-size:25px;">
   	  
<b>Theorem 1</b> (Existance and uniqueness).
<i>
Assume that \eqref{hp:rho} and \eqref{hp:v} are satisfied. Then there exists a unique entropy solution according to <i>Definition 1</i>.
</i>
</p>

	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>
	  <h5>Theoretical analysis</h5>

<p style="text-align:left;font-size:25px;">
   	  
<b>Theorem 1</b> (Existance and uniqueness).
<i>
Assume that \eqref{hp:rho} and \eqref{hp:v} are satisfied. Then there exists a unique entropy solution according to <i>Definition 1</i>.
</i>

<br> <br>

<b>Theorem 2</b> (Convergence).
<i>
Assume that \eqref{hp:rho} and \eqref{hp:v} are satisfied. Moreover, assume that at least one of the two conditions \eqref{addhp:rho} and \eqref{addhp:v} are satisfied.
Then $\rho^{n}$ converges (up to a subsequence) almost everywhere and in $\mathcal{L}^{1}_{loc}$ on $\mathbb{R}_{+} \times \mathbb{R}$ to the unique entropy solution $\rho$ to the Cauchy problem \eqref{cauchy}, according to <i>Definition 1</i>.
</i>

</p>

	</section>
	

	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>
	  <h5>Theoretical analysis</h5>

	  <h6>Follow-The-Leader model: approximating scheme.</h6>

	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Follow-The-Leader model: approximating scheme.</h6>

<p style="text-align:left;font-size:25px;">

For $n \in \mathbb{N}$ sufficiently large, we set $\ell_{n} \dot{=}\ \frac{1}{n}$ and we define:

\begin{equation*}
\bar{x}^{n}_{1}\ \dot{=}\ \text{sup} \bigg\{ x \in \mathbb{R}: \int_{-\infty}^{x} \bar{\rho}(x)\ dx\ < \ell_{n} \bigg\},
\end{equation*}

and for $i\ \in\ \{2,...,n-1\}$ recursively:
\begin{equation*}
\bar{x}^{n}_{i}\ \dot{=}\ \text{sup} \bigg\{ x \in \mathbb{R}: \int_{\bar{x}^{n}_{i-1}}^{x} \bar{\rho}(x)\ dx\ < \ell_{n} \bigg\}.
\end{equation*}

</p>

	</section>
	
	
	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Follow-The-Leader model: approximating scheme.</h6>

<p style="text-align:left;font-size:25px;">

From this definition we get a monotonicity property:

\begin{equation*}
\bar{x}^{n}_{1}<\bar{x}^{n}_{2}<...<\bar{x}^{n}_{n-1},
\end{equation*}

and we have equal mass $\ell_{n}$ on each interval:
\begin{equation*}
\int_{-\infty}^{\bar{x}^{n}_{1}} \bar{\rho}(x) dx\ =\ \int_{\bar{x}^{n}_{i-1}}^{\bar{x}^{n}_{i}} \bar{\rho}(x) dx\ =\ \int_{\bar{x}^{n}_{n-1}}^{+\infty} \bar{\rho}(x) dx\ =\ \ell_n,\qquad i \in \{2,...,n-1\}.
\end{equation*}

</p>

	</section>
	

	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Follow-The-Leader model: approximating scheme.</h6>

<p style="text-align:left;font-size:25px;">

Let the particles $\{\bar{x}^{n}_{i}\}^{n-1}_{i=1}$ evolve according to the <i>Follow-The-Leader</i> system of ODEs:

\begin{equation} \label{ftl}
\left\{
    \begin{aligned}
        & \dot{x}^{n}_{i}(t) = v(R^{n}_{i}(t)),\quad\ &i \in \{1,...,n-2\},\\
        & \dot{x}^{n}_{n-1}(t) = v_{max}, \\
        & x^{n}_{i}(0) = \bar{x}^{n}_{i},\quad\ &i \in \{1,...,n-1\}, \\
    \end{aligned}
\right.
\end{equation}

where we define:

\begin{equation} \label{Ri}
R^{n}_{i}(t)\ \dot{=}\ \frac{\ell_{n}}{x^{n}_{i+1}(t)-x^{n}_{i}(t)}, \qquad
R\ \dot{=}\ \|\bar{\rho}\|_{\mathcal{L}^{\infty}(\mathbb{R})},
\end{equation}

</p>

	</section>
	
	
	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Follow-The-Leader model: approximating scheme.</h6>

<p style="text-align:left;font-size:25px;">


<b>Lemma 1</b> (Discrete Maximum Principle).
<i>
Assume that \eqref{hp:rho} and \eqref{hp:v} are satisfied. Then $\forall t \in \mathbb{R}_{+}$ the solution to \eqref{ftl} satisfies

\begin{equation*}
x^{n}_{i+1}(t)-x^{n}_{i}(t) \geq \frac{\ell_{n}}{R}, \qquad i \in \{1,...,n-2\}.
\end{equation*}

</i>

</p>

	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Follow-The-Leader model: approximating scheme.</h6>

<p style="text-align:left;font-size:25px;">

To get a time-depending density with unit mass we set two <i>artificial particles</i> $x^{n}_{0}(t)$ and $x^{n}_{n}(t)$ for all $t \geq 0$ as:

\begin{equation} \label{artp}
x^{n}_{0}(t)\ \dot{=}\ 2x^{n}_{1}(t) - x^{n}_{2}(t),\qquad x^{n}_{n}(t)\ \dot{=}\ 2x^{n}_{n-1}(t) - x^{n}_{n-2}(t),
\end{equation}

</p>

	</section>	
	
	
	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Follow-The-Leader model: approximating scheme.</h6>

<p style="text-align:left;font-size:25px;">

To get a time-depending density with unit mass we set two <i>artificial particles</i> $x^{n}_{0}(t)$ and $x^{n}_{n}(t)$ for all $t \geq 0$ as:

\begin{equation*}
x^{n}_{0}(t)\ \dot{=}\ 2x^{n}_{1}(t) - x^{n}_{2}(t),\qquad x^{n}_{n}(t)\ \dot{=}\ 2x^{n}_{n-1}(t) - x^{n}_{n-2}(t),
\end{equation*}

and let
\begin{equation*}
R^{n}_{0}(t)\ \dot{=}\ R^{n}_{1}(t), \qquad R^{n}_{n}(t)\ \dot{=}\ R^{n}_{n-1}(t).
\end{equation*}

</p>

	</section>	


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Follow-The-Leader model: approximating scheme.</h6>

<p style="text-align:left;font-size:25px;">

\begin{equation} \label{density:def}
  \begin{aligned}
  \rho^{n}(t,x)\ \dot{=}&\ \sum_{i=0}^{n-1} R^{n}_{i}(t)\ \unicode{x1D7D9}_{[x^{n}_{i}(t),x^{n}_{i+1}(t)]}(x)\\
  =&\ \sum_{i=0}^{n-1} \frac{\ell_{n}}{x^{n}_{i+1}(t)-x^{n}_{i}(t)}\  \unicode{x1D7D9}_{[x^{n}_{i}(t),x^{n}_{i+1}(t)]}(x),
\end{aligned}
\end{equation}

</p>

	</section>	


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Follow-The-Leader model: approximating scheme.</h6>

<p style="text-align:left;font-size:25px;">

$\rho^{n}(t,x)$ has the properties:

\begin{equation*}
\int_{\mathbb{R}}\rho^{n}(t,x) dx\ = n,\\
\rho^{n}(t,\cdot) \text{ is compactly supported $\forall\,n,t$},\\
\|\rho^{n}(t,\cdot)\|_{\mathcal{L}^{\infty}(\mathbb{R})} \leq R\ \dot{=}\ \|\bar{\rho}\|_{\mathcal{L}^{\infty}(\mathbb{R})} \quad \forall t \geq 0.
\end{equation*}

</p>

	</section>	

	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Follow-The-Leader model: approximating scheme.</h6>

<p style="text-align:left;font-size:25px;">

If $\text{supp}\left[ \bar{\rho} \right]$ is bounded either from above or from below, then we can improve the construction as follows:

  <ul style="text-align:left; font-size:25px;">
        <li>
<b>$\text{supp}\left[ \bar{\rho} \right]$ bounded from above</b>:
<br>
Set $x^{n}_{n}$ on $\max\{ \text{supp}\left[ \bar{\rho} \right] \}$ initially and let evolve  with maximum speed $v_{max}$, and the preceding particle $x^{n}_{n-1}$ let evolve according to $\dot{x}^{n}_{i}(t) = v\left( \frac{\ell_{n}}{x^{n}_{i+1}(t)-x^{n}_{i}(t)} \right)$;
        </li>
        <li>
<b>$\text{supp}\left[ \bar{\rho} \right]$ bounded from below</b>:
<br>
Set $x^{n}_{0}$ on $\min\{ \text{supp}\left[ \bar{\rho} \right] \}$ initially and let it evolve via $\dot{x}^{n}_{0}(t) = v \left( \frac{\ell_{n}}{x^{n}_{1}(t)-x^{n}_{0}(t)} \right)$.
        </li>
  </ul>

</p>

	</section>	


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof</h6>

	</section>
	
	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof</h6>

<p style="text-align:left;font-size:25px;">

<b>Theorem 2</b> (Convergence).
<i>
Assume that \eqref{hp:rho} and \eqref{hp:v} are satisfied. Moreover, assume that at least one of the two conditions \eqref{addhp:rho} and \eqref{addhp:v} are satisfied.
Then $\rho^{n}$ converges (up to a subsequence) almost everywhere and in $\mathcal{L}^{1}_{loc}$ on $\mathbb{R}_{+} \times \mathbb{R}$ to the unique entropy solution $\rho$ to the Cauchy problem \eqref{cauchy}, according to <i>Definition 1</i>.
</i>

</p>

    </section>	



	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof: compactness</h6>

	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof: compactness</h6>

<p style="text-align:left;font-size:25px;">

To gain compactness of the approximating scheme we need a uniform control for the $\mathcal{BV}$-norm. In our case, the compactness can be obtained in two different ways.

</p>

    </section>	

	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof: compactness</h6>

<p style="text-align:left;font-size:25px;">
<b>First way:</b>
A uniform $\mathcal{BV}$ contraction property for $\rho^{n}$, which requires $\mathcal{BV}$ initial data \eqref{addhp:rho}.

<br>
<br>

<b>Proposition 1</b>.
<i>
Assume that \eqref{hp:rho}, \eqref{addhp:rho} and \eqref{hp:v} are satisfied. Then, for all $n \in \mathbb{N}$ one has
\begin{equation}
TV\left[\rho^{n}(t,\cdot)\right] \leq TV\left[\rho^{n}(0,\cdot)\right] \leq TV\left[\bar{\rho}\right].
\end{equation}
</i>

</p>

    </section>	


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof: compactness</h6>

<p style="text-align:left;font-size:25px;">
<b>Second way:</b> Use the <i>discrete Oleinik-type inequality</i>, which doesn't require the extra-assumption \eqref{addhp:rho} on $\bar{\rho}$, but only the additional assumpton \eqref{addhp:v} on $v$.

<br>
<br>


<b>Proposition 2</b>.
<i>
Assume that \eqref{hp:rho}, \eqref{hp:v} and \eqref{addhp:v} are satisfied. Then, for all $n \geq 0$ one has
\begin{equation} \label{oleinik:ineq}
\dfrac{\dot{x}^{n}_{i+1}(t)-\dot{x}^{n}_{i}(t) }{x^{n}_{i+1}(t)-x^{n}_{i}(t) } \leq \frac{1}{t}, \qquad i \in \{0,...,n-1\}.
\end{equation}
</i>

<b>Proposition 3</b>.

<i>
Assume that \eqref{hp:rho}, \eqref{hp:v} and \eqref{addhp:v} are satisfied. Let $\delta > 0,\, a < b$. Then:

\begin{equation*}
\sup_{t \geq \delta} \text{TV} \big(\rho^{n}(t,\cdot); \left[ a,b \right]\big)
\end{equation*}

is uniformly bounded with respect to $n$.
</i>

</p>

    </section>	


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof: compactness</h6>

<p style="text-align:left;font-size:25px;">

To achieve strong $\mathcal{L}^{1}$ compactness w.r.t. both $x$ and $t$ we consider <i>1-Wasserstein distance</i>.

<br>
<br>

<b>Definition 2</b> (1-Wasserstein distance).
<i>
  Let $\mu$ be a probability measure on $\mathbb{R}$. Define the pseudo-inverse variable $X_{\mu} \in \mathcal{L}^{1}([0,1])$ as
  \begin{equation*}
    X_{\mu}(z)\ \dot{=}\ \inf\left\{ x \in \mathbb{R} : \mu \left( (-\infty,x] \right) > z \right\}.
  \end{equation*}
  
  Given two probability measures $\mu$ and $\nu$ on $\mathbb{R}$, we set:
  \begin{equation*}
    W_{1}(\mu,\nu)\ \dot{=}\ \|X_{\mu} - X_{\nu}\|_{\mathcal{L}^1_{[0,1]}}.
  \end{equation*}
  
</i>

    </section>	

	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof: compactness</h6>

<p style="text-align:left;font-size:25px;">

<b>Proposition 4</b>.
<i>

Assume \eqref{hp:rho} and \eqref{hp:v} are satisfied. There exists a constant $C$ independent of $n$, such that
  \begin{equation*}
    W_{1} (\rho^{n}(t,\cdot), \rho^{n}(s,\cdot) ) \leq C |t-s| \quad \forall \text{t,s} > 0.
  \end{equation*}
  
</i>

    </section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof: compactness</h6>

<p style="text-align:left;font-size:25px;">

<b>Theorem 3</b> (Generalised Aubin-Lions lemma).

<i>
  Let $\,T > 0, \,a,b \in \mathbb{R}, a < b$ and $v$ satisfy \eqref{hp:v}. Let $\rho^{n}$ be a sequence in $\mathcal{L}^{\infty} \left( (0,T);\ \mathcal{L}^{1}(\mathbb{R}) \right)$ with:
  
    \begin{equation*}
\rho^{n} (t, \cdot) \geq 0, \quad \| \rho^{n} (t, \cdot) \|_{\mathcal{L}^{1}(\mathbb{R})} = 1 \; \forall n \in \mathbb{N}, \; \forall t \in \left[ 0,T \right].
     \end{equation*}
  Assume further that:
</i>

   <ul style="text-align:left; font-size:25px;">
        <li>
$\sup_{n \in \mathbb{N}} \left[ \int_{0}^{T} \big[ \| v(\rho^{n}(t, \cdot)) \|_{\mathcal{L}^{1} ( \left[ a,b \right] ) } + TV \left( v(\rho^{n}(t,\cdot));\ \left[ a,b \right] \right)  \big] dt \right] < +\infty,$
        </li>
        <li>
$\exists\, C>0$ independent of $n$ such that
    \begin{equation*}
       W_{1} (\rho^{n}(t,\cdot), \rho^{n}(s,\cdot) ) \leq C |t-s| \quad \forall \text{t,s} \in (0,T).
     \end{equation*}
        </li>
  </ul>

<p style="text-align:left;font-size:25px;">

<i>
Then $\rho^{n}$ is strongly relatively compact in $\mathcal{L}^{1} \left( \left[ 0,T \right] \times \left[ a,b \right]\right)$.  
</i>

</p>

    </section>




	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof: convergence</h6>

    </section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof: convergence</h6>

<p style="text-align:left;font-size:25px;">

Once gained strong $\mathcal{L}^{1}$ compactness and by passing from $\left[ \delta, T \right]$ to $( 0,T )$, one can show that $\rho^{n}$ admits a converging subsequence a.e. in $\mathcal{L}^{1} \left( \left( 0,T \right) \times \mathbb{R} \right)$. Denote $\rho$ such limit.

</p>

    </section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof: convergence</h6>

<p style="text-align:left;font-size:25px;">
<b>Step 1: $\rho$ is a weak solution to \eqref{cauchy}.</b>
Let $\varphi \in \text{C}^{\infty}_{\text{c}} \left( \mathbb{R}_{+} \times \mathbb{R} \right)$ and compute:

\begin{align*}

\def\avint{\mathop{\,\rlap{-}\!\!\int}\nolimits}

  & \iint_{\mathbb{R}_{+} \times \mathbb{R}} \Big[ \rho^{n} (t,x)\, \varphi_{t} \left( t, x \right)  + \rho^{n}(t,x)\, v( \rho^{n}(t,x) )\, \varphi_{x} \left( t,x \right)  \Big] dx\, dt\\
  & \leq \ 2 \ell_{n} \| \varphi (0,\cdot) \|_{\mathcal{L}^{\infty}(\mathbb{R})} + \sum_{i=0}^{n-1} \left| \int_{\bar{x}_{i}^{n}}^{\bar{x}_{i+1}^{n}} \bar{\rho} (x) \left[ \varphi (0,x) - \avint_{\bar{x}_{i}^{n}}^{\bar{x}_{i+1}^{n}} \varphi (0,y)\, dy \right] dx \right|
\end{align*}

</p>

    </section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof: convergence</h6>

<p style="text-align:left;font-size:25px;">
<b>Step 1.</b>
<i>Case 1: $\bar{\rho}$ is compactly supported.</i>

Assume $\text{supp}[\varphi] \subset [\delta, T] \times \mathbb{R}$ for $0 < \delta < T$,

\begin{align*}
  & \Bigg| \iint_{\mathbb{R}_{+} \times \mathbb{R}} \Big[ \rho^{n} (t,x)\, \varphi_{t} \left( t, x \right)  + \rho^{n}(t,x)\, v( \rho^{n}(t,x) )\, \varphi_{x} \left( t,x \right)  \Big] dx \, dt \Bigg| \nonumber \\
 & \leq\  \dfrac{T\, \text{Lip}[ \varphi ] \ell_{n}}{2} \Bigg[ v_{max} - v(R) + \sup_{t \in [ \delta,T ]} TV \left( v (\rho^{n} (t, \cdot)) ; J(T) \right) \Bigg]
\end{align*}

where $J(T) \dot{=} \left[ \min \left\{ \text{supp} \left[ \bar{\rho} \right] \right\} + v(R)\, T,\; \max \left\{ \text{supp} \left[ \bar{\rho} \right] \right\} + v_{max}\, T \right] $.

</p>

    </section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof: convergence</h6>

<p style="text-align:left;font-size:25px;">
<b>Step 1.</b>
<i>Case 2: $\bar{\rho}$ is not compactly supported.</i>
Assume $\text{supp} \left[ \bar{\rho} \right]$ unbounded both from above and from below. 

<br>
<br>

Assume $\text{supp} \left[ \varphi \right] \subset \left[ \delta, T\right] \times \left[ a,b \right]$ for some $0 < \delta < T$ and $ a < b$. Let $n \in \mathbb{N}$ be sufficiently large so that $\bar{x}_{1}^{n} < a - v_{max}\, T$ and $\bar{x}_{n-1}^{n} > b - v(R)\, T$.

<br>
<br>

Therefore $x_{1}^{n}(t) < a$ and ${x}_{n-1}^{n}(t) > b \;\; \forall t \in \left[ 0,T \right]$.

<p style="text-align:left;font-size:20px;">
\begin{align*}
  & \Bigg| \iint_{\mathbb{R}_{+} \times \mathbb{R}} \Big[ \rho^{n} (t,x)\, \varphi_{t} \left( t, x \right)  + \rho^{n}(t,x)\, v( \rho^{n}(t,x) )\, \varphi_{x} \left( t,x \right)  \Big] dx \; dt \Bigg| \\
  & =\  \Bigg| \sum_{i=0}^{n-1} \int_{\mathbb{R}_{+}} R_{i}^{n} (t) \Bigg[ \int_{x_{i}^{n}(t)}^{x_{i+1}^{n}(t)} \varphi_{t} \left( t,x \right) dx + v(R_{i}^{n} (t)) \Big[ \varphi(t, x_{i+1}^{n}(t)) - \varphi(t, x_{i}^{n}(t)) \Big] \Bigg] dt \Bigg|
\end{align*}
</p>

</p>

    </section>



	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof: convergence</h6>

<p style="text-align:left;font-size:25px;">
<b>Step 2: $\rho$ satisfies the entropy inequality in Definition 1.</b>

Let $\varphi \in \text{C}^{\infty}_{\text{c}} \left( \left( 0,+\infty \right) \times \mathbb{R} \right)$ with $\varphi \geq 0$ and $k \geq 0$.

<p style="text-align:left;font-size:20px;">
\begin{align*}
  & \iint\limits_{\mathbb{R}^{+} \times \mathbb{R}} \bigg[ |\rho(t,x) - k| \varphi_{t}(t,x)\ +\ \text{sign}(\rho(t,x) - k) \left[ f(\rho(t,x)) - f(k)\right]\varphi_{x}(t,x)\bigg] dx \, dt \\
  & =\ k \int_{\mathbb{R}^{+}} \Big[ \big[ v(k) - \dot{x}_{0}^{n}(t) \big] \varphi(t, x_{0}^{n}(t)) + \big[ v(k) - \dot{x}_{n}^{n}(t) \big] \varphi(t, x_{n}^{n}(t)) \Big] dt\\
  & \hspace{20pt} + \sum_{i=0}^{n-1} \int_{\mathbb{R}^{+}} \text{sign} \left( R_{i}^{n}(t) - k \right) \Bigg[ - \dot{R}_{i}^{n} (t) \left( \int_{x_{i}^{n}(t)}^{x_{i+1}^{n}(t)} \varphi (t,x) dx \right)\\
  & \hspace{20pt} - \Big[ R_{i}^{n} (t) \left[ \dot{x}_{i+1}^{n}(t) - v(R_{i}^{n} (t)) \right] - k \left[ \dot{x}_{i+1}^{n}(t) - v(k) \right] \Big] \varphi (t, x_{i+1}^{n}(t))\\
  & \hspace{20pt} + \Big[ R_{i}^{n} (t) \left[ \dot{x}_{i}^{n}(t) - v(R_{i}^{n} (t)) \right] - k \left[ \dot{x}_{i}^{n}(t) - v(k) \right] \Big] \varphi (t, x_{i}^{n}(t)) \Bigg] dt.\\
\end{align*}
</p>

</p>
    </section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof: convergence</h6>

<p style="text-align:left;font-size:25px;">

<b>Step 2.</b>
<i>Case 1: $\bar{\rho}$ is compactly supported.</i>

Assume $\text{supp}[\varphi] \subset [\delta, T] \times \mathbb{R}$ for $0 < \delta < T$,

<p style="text-align:left;font-size:20px;">
\begin{align*}
  & \iint\limits_{\mathbb{R}^{+} \times \mathbb{R}} \bigg[ |\rho(t,x) - k|\varphi_{t}(t,x)\ + \text{sign} ( \rho(t,x) - k) \left[ f(\rho(t,x)) - f(k)\right]\varphi_{x}(t,x)\bigg] dx \, dt \\
  =&\ k \int_{\mathbb{R}^{+}} \Big[ \big[ v(k) - v(R_{0}^{n}(t)) \big] \varphi(t, x_{0}^{n}(t)) - \big[ v(k) - v_{max} \big] \varphi(t, x_{n}^{n}(t)) \Big] dt\\
  &+ \sum_{i=0}^{n-2} \int_{\mathbb{R}^{+}} \text{sign} \left( R_{i}^{n}(t) - k \right) \Bigg[ \dfrac{R^{n}_{i}(t)^{2}}{\ell_{n}} \Bigg( \int_{x_{i}^{n}(t)}^{x_{i+1}^{n}(t)} \varphi (t,x) - \varphi (t, x_{i+1}^{n}(t)) dx \Bigg)  \Big[ v(R^{n}_{i+1}(t)) - v(R^{n}_{i}(t))\Big] \\
  & \hspace{5pt}  + k \Big[ \left[ v(R^{n}_{i+1}(t)) - v(k) \right] \varphi (t, x_{i+1}^{n}(t)) - \left[ v(R^{n}_{i}(t)) - v(k) \right] \varphi (t, x_{i}^{n}(t)) \Big] \Bigg] dt\\
  &+ \int_{\mathbb{R}^{+}} \text{sign} \left( R_{n-1}^{n}(t) - k \right) \Bigg[ \dfrac{R^{n}_{n-1}(t)^{2}}{\ell_{n}} \Bigg( \int_{x_{n-1}^{n}(t)}^{x_{n}^{n}(t)} \varphi (t,x) - \varphi (t, x_{n}^{n}(t)) dx \Bigg) \Big[ v_{max} - v(R^{n}_{n-1}(t)) \Big]\\
  & \hspace{5pt}  + k \Big[ \left[ v_{max} - v(k) \right] \varphi (t, x_{n}^{n}(t)) - \left[ v(R^{n}_{n-1}(t)) - v(k) \right] \varphi (t, x_{n-1}^{n}(t)) \Big] \Bigg] dt
\end{align*}

</p>

</p>
    </section>

	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Sketch of the proof: convergence</h6>

<p style="text-align:left;font-size:25px;">

<b>Step 2.</b>
<i>Case 2: $\bar{\rho}$ is not compactly supported.</i>
Assume $\text{supp} \left[ \bar{\rho} \right]$ unbounded both from above and from below. 

</p>

<p style="text-align:left;font-size:20px;">

\begin{align*}
  & \iint\limits_{\mathbb{R}^{+} \times \mathbb{R}} \bigg[ \left| \rho(t,x) - k \right| \varphi_{t}(t,x)\ + \text{sign} (\rho(t,x) - k) \left[ f(\rho(t,x)) - f(k)\right] \varphi_{x}(t,x)\bigg] dx \, dt \\
  & = \sum_{i=1}^{n-2} \int_{\mathbb{R}^{+}} \Bigg[ | R_{i-1}^{n}(t) - k | \Bigg( \int_{x_{i}^{n}(t)}^{x_{i+1}^{n}(t)} \varphi_{t} (t,x) \Bigg) + \text{sign} \left( R_{i}^{n}(t) - k \right) \Big[  f(R_{i}^{n}(t)) - f(k) \Big] \Big[ \varphi (t, x_{i+1}^{n}(t)) -  \varphi (t, x_{i}^{n}(t)) \Big] \Bigg] dt
\end{align*}

</p>

<p style="text-align:left;font-size:25px;">

for all $\varphi \in \text{C}^{\infty}_{\text{c}} \left( \left( 0, +\infty \right) \times \mathbb{R} \right)$

</p>
    </section>



	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="LightYellow">
      <h3>Traffic models</h3>

	  <h6>Numerics</h6>

<p style="text-align:left;font-size:25px;">



</p>
    </section>







	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Strategie di controllo</h3>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Strategie di controllo</h3>
   	  <p style="font-size:25px;">
        I principali problemi di controllo riguardano:
	  </p>
	  <ul style="font-size:25px;">
	    <li>minimizzare il numero totale di infetti;</li>
	    <li>minimizzare la durata dell'epidemia.</li>
	  </ul>
	</section>



	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Controllo ottimo tempo ottimale</h3>
   	  <p style="font-size:25px;">
    Riscriviamo il sistema SIR nella forma compatta $\dot{\boldsymbol{x}} = f(\boldsymbol{x})$, con $\boldsymbol{x}(t) = (S(t),I(t))^\top$.
	  </p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Controllo ottimo tempo ottimale</h3>
   	  <p style="font-size:25px;">
    Riscriviamo il sistema SIR nella forma compatta $\dot{\boldsymbol{x}} = f(\boldsymbol{x})$, con $\boldsymbol{x}(t) = (S(t),I(t))^\top$.
	  </p>
   	  <p style="font-size:25px;">
        Applicando il generico termine di controllo $u(t)$, otteniamo il sistema controllato
    \[
    \dot{\boldsymbol{x}}(t) = f(\boldsymbol{x}(t)) + u(t)g(\boldsymbol{x}(t)),
    \]
	</p>
    <p style="line-height: 40px;font-size:25px;">
    dove $g$ dipende dalla strategia di controllo scelta
    \[
    \small g_l(\boldsymbol{x}) =
    \begin{pmatrix}
    -\alpha_1 S\\
    -\alpha_2 I
    \end{pmatrix}.
    \]
	</p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Controllo ottimo tempo ottimale</h3>
   	  <p style="text-align:left;font-size:25px;">
   	  <b>Definizione</b> (Tempo di eradicazione).
<i>Il tempo di eradicazione $T$ del problema SIR con controllo è il primo tempo per il quale il numero di infetti raggiunge una certa soglia $\varepsilon < 1$, dove $\varepsilon$ è una costante positiva fissata.</i>
	  </p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Controllo ottimo tempo ottimale</h3>
        \[
        \Tiny
        \begin{aligned}
            & \min_{u(t)}
            & & J(u) = \int_{0}^{T}1dt \quad \text{(Tempo di eradicazione)}\\
            & \text{ t.c.}
            & & \dot{\boldsymbol{x}}(t) =
            f(\boldsymbol{x}(t)) + u(t)g(\boldsymbol{x}(t)),\quad t \geq 0;\\
            &&& \boldsymbol{x}(0) = \boldsymbol{x}_0,\quad
            \boldsymbol{x}(T) \in \mathcal{C} =
            \left\{(S,I) : I = \varepsilon \right\}\\
            &&& u : [0,+\infty) \rightarrow U = [0,u^{max}]~\text{continua a tratti}.
        \end{aligned}
        \]
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Controllo ottimo tempo ottimale</h3>
   	  <p style="text-align:left; font-size:25px;">
   	  <b>Teorema</b>.
<i>Se $u_{l}^{*}$ è il termine lineare che rappresenta la strategia ottima per il problema di controllo, allora $u_{l}^{*}$ è un controllo <b>bang-bang</b> con un solo tempo di commutazione $\tau_{s}^{*}$, da nessun controllo a massimo controllo.</i>
	  </p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Controllo ottimo tempo ottimale</h3>
   	  <p style="text-align:left; font-size:25px;">
   	  <b>Teorema</b>.
<i>Se $u_{l}^{*}$ è il termine lineare che rappresenta la strategia ottima per il problema di controllo, allora $u_{l}^{*}$ è un controllo <b>bang-bang</b> con un solo tempo di commutazione $\tau_{s}^{*}$, da nessun controllo a massimo controllo.</i>
	  </p>
        \[
        \Tiny
        \begin{aligned}
            \mathcal{A} =
            \Bigl\{
            & u :[0,+\infty) \rightarrow \left\{0,u^{max}\right\}~
            \text{costante a tratti con al massimo} \\[10pt]
            & \text{un salto da 0 a } u^{max},
            ~\lim_{t \to +\infty} u(t) = u^{max}
            \Bigr\}.
        \end{aligned}
        \]
	</section>



	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Vaccinazione</h3>
   	  <p style="text-align:left; font-size:25px;">
        Il termine lineare per questa politica di controllo è
        \[
        \alpha_1 = 1,~\alpha_2 = 0:
        \quad g_v(\boldsymbol{x}) =
        \begin{pmatrix}
        - S\\
        0
        \end{pmatrix}
        \]
      <p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Vaccinazione</h3>
       	  <p style="text-align:left; font-size:25px;">
            Il termine lineare per questa politica di controllo è
            \[
            \alpha_1 = 1,~\alpha_2 = 0:
            \quad g_v(\boldsymbol{x}) =
            \begin{pmatrix}
            - S\\
            0
            \end{pmatrix}
            \]
          <p>
        <p style="text-align:left; font-size:25px;">
            e otteniamo il sistema seguente
            \[
            \left\{
                \begin{alignedat}{2}
                    \dot{S}(t) & = -\beta S(t)I(t) - u_{v}(t)S(t) \\
                    \dot{I}(t) & = \beta S(t)I(t) {} - {} \gamma I(t) \\
                \end{alignedat}
            \right.
            \]
            con $u_{v}(t) \in \mathcal{A}$ termine di controllo per la politica  di vaccinazione.
        </p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Vaccinazione</h3>
        <p style="text-align:left; font-size:25px;">
            e otteniamo il sistema seguente
            \[
            \left\{
                \begin{alignedat}{2}
                    \dot{S}(t) & = -\beta S(t)I(t) - u_{v}(t)S(t) \\
                    \dot{I}(t) & = \beta S(t)I(t) {} - {} \gamma I(t) \\
                \end{alignedat}
            \right.
            \]
            con $u_{v}(t) \in \mathcal{A}$ termine di controllo per la politica  di vaccinazione.
        </p>
   	  <p style="text-align:left;line-height: 40px; font-size:25px;">
   	  <b>Teorema</b>.
        <i>Il tempo di commutazione $\tau_{s}^{*}$ può verificarsi solamente prima del picco delle infezioni.</i>
	  </p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Isolamento degli infetti</h3>
   	  <p style="text-align:left; font-size:25px;">
        Il termine lineare per questa politica di controllo è
        \[
        \alpha_1 = 0,~\alpha_2 = 1: \quad g_i(\boldsymbol{x}) =
        \begin{pmatrix}
        0\\
        - I
        \end{pmatrix}
        \]
      <p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Isolamento degli infetti</h3>
   	  <p style="text-align:left; font-size:25px;">
        Il termine lineare per questa politica di controllo è
        \[
        \alpha_1 = 0,~\alpha_2 = 1: \quad g_i(\boldsymbol{x}) =
        \begin{pmatrix}
        0\\
        - I
        \end{pmatrix}
        \]
      <p>
        <p style="text-align:left; font-size:25px;">
            e otteniamo il sistema seguente
            \[
            \left\{
            \begin{aligned}
                \dot{S}(t) & = -\beta S(t)I(t) \\
                \dot{I}(t) & = \beta S(t)I(t) {} - {} \gamma I(t) - u_{i}(t)I(t)\\
            \end{aligned}
            \right.
            \]
            con $u_{i}(t) \in \mathcal{A}$ termine di controllo nel caso dell'isolamento.
        </p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Isolamento degli infetti</h3>
        <p style="text-align:left; font-size:25px;">
            e otteniamo il sistema seguente
            \[
            \left\{
            \begin{aligned}
                \dot{S}(t) & = -\beta S(t)I(t) \\
                \dot{I}(t) & = \beta S(t)I(t) {} - {} \gamma I(t) - u_{i}(t)I(t)\\
            \end{aligned}
            \right.
            \]
            con $u_{i}(t) \in \mathcal{A}$ termine di controllo nel caso dell'isolamento.
        </p>
   	  <p style="text-align:left;line-height: 40px; font-size:25px;">
   	  <b>Teorema</b>.
        <i>Il tempo di commutazione $\tau_{s}^{*}$ può verificarsi dopo il picco delle infezioni e non necessariamente prima. Ritardare il controllo è strategia ottima anche quando il numero di infetti aumenta, ovvero per $\dot{I}(t)>0$.</i>
	  </p>
	</section>




	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">

	  <h3>Strategie a confronto</h3>

	  <table style="width:65%; font-size:25px;">

      <caption align="top">
          Vaccinazione a sinistra, Isolamento degli infetti a destra.
      </caption>

	    <tr>
	      <td style="width:50%; border-bottom:0px;">
		<img class="fragment fade-right"
			 src="immagini/vaccinazione/subplot1.svg"
			 alt="modello sir" />
	      </td>

	      <td style="border-bottom:0px;">
		<img class="fragment fade-left"
			 src="immagini/isolamento/subplot1.svg"
			 alt="modello sir" />
	      </td>
	    </tr>

	    <tr>
	      <td style="width:50%; border-bottom:0px;">
		<img class="fragment fade-right"
			 src="immagini/vaccinazione/subplot3.svg"
			 alt="modello sir"/>
	      </td>

	      <td style="border-bottom:0px;">
		<img class="fragment fade-left"
			 src="immagini/isolamento/subplot3.svg"
			 alt="modello sir" />
	      </td>
	    </tr>

	  </table>

	</section>





	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h4>Controllo istantaneo mediante lockdown</h4>
        <p style="text-align:left; font-size:25px;">
    </section>



	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h4>Controllo istantaneo mediante lockdown</h4>
        <p style="text-align:left; font-size:25px;">
        Il generico sistema controllato
            \[
            \left\{
            \begin{aligned}
                \dot{S}(t) & = -(\beta_0 + u(t)) S(t)I(t) \\
                \dot{I}(t) & = (\beta_0 + u(t)) S(t)I(t) {} - {} \gamma I(t) \\
            \end{aligned}
        \right.
            \]
        e l'insieme dei controlli ammissibili è
            \[
            \begin{aligned}
                \mathcal{A} =
                \Bigl\{
                u :[0,+\infty) \rightarrow [-\beta_0,0]
                \text{ tali che } \beta_0 + u(t) \geq 0
                \Bigr\}.
            \end{aligned}
            \]
        </p>
	</section>

	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h4>Controllo istantaneo mediante lockdown</h4>
        <p style="font-size:25px;">
        \[
        \begin{aligned}
            & \min_{u(t)}
            & & J(u(t);S_0,I_0) =
                \int_{t}^{t+\Delta t}\lvert I(t) \rvert + \frac{\eta}{2}\,
                \lvert u(t) \rvert^{2}dt\\
            & \text{ t.c. }
            & & \dot{\boldsymbol{x}}(t) = f(\boldsymbol{x}(t)),\quad t \geq 0;\\
            & & & u(t) \in \mathcal{A};
        \end{aligned}
        \]
        </p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Modello $\kappa$-SIR</h3>
        <p style="text-align:left; font-size:25px;">
        \[
        \left\{
        \begin{aligned}
            \dot{S}(t) & =
            -\biggl(\beta_0 -\frac{S(t)I(t)}{\kappa}\biggr) S(t)I(t) \\[4pt]
            \dot{I}(t) & =
            \biggl(\beta_0 - \frac{S(t)I(t)}{\kappa}\biggr) S(t)I(t) - \gamma I(t)
        \end{aligned}
        \right.
        \]
        </p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Modello $\kappa$-SIR</h3>
        <p style="text-align:left; font-size:25px;">
        \[
        \left\{
        \begin{aligned}
            \dot{S}(t) & =
            -\biggl(\beta_0 -\frac{S(t)I(t)}{\kappa}\biggr) S(t)I(t) \\[4pt]
            \dot{I}(t) & =
            \biggl(\beta_0 - \frac{S(t)I(t)}{\kappa}\biggr) S(t)I(t) - \gamma I(t)
        \end{aligned}
        \right.
        \]
        </p>
        <p style="text-align:left; font-size:25px;">
        L'ammissibilità del controllo $u(t) \in \mathcal{A}$ è legata alla seguente condizione non lineare
        \[
        \beta(t) \geq 0 \iff \kappa \geq \frac{S(t)I(t)}{\beta_0}.
        \]
        </p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Modello $\kappa$-SEIR</h3>
        <p style="text-align:left; font-size:25px;">
        \[
        \left\{
        \begin{aligned}
            \dot{S}(t) & =
            -\biggl(\beta_0 -\frac{S(t)I(t)}{\kappa}\biggr) S(t)I(t) \\[4pt]
            \dot{E}(t) & =
            \biggl(\beta_0 -\frac{S(t)I(t)}{\kappa}\biggr) S(t)I(t) - \mu E(t)\\[4pt]
            \dot{I}(t) & = \mu E(t) - \gamma I(t)
        \end{aligned}
        \right.
        \]
        </p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">
	  <h3>Modello $\kappa$-SEIR</h3>
        <p style="text-align:left; font-size:25px;">
        \[
        \left\{
        \begin{aligned}
            \dot{S}(t) & =
            -\biggl(\beta_0 -\frac{S(t)I(t)}{\kappa}\biggr) S(t)I(t) \\[4pt]
            \dot{E}(t) & =
            \biggl(\beta_0 -\frac{S(t)I(t)}{\kappa}\biggr) S(t)I(t) - \mu E(t)\\[4pt]
            \dot{I}(t) & = \mu E(t) - \gamma I(t)
        \end{aligned}
        \right.
        \]
        </p>
        <p style="text-align:left; font-size:25px;">
        L'ammissibilità del controllo $u(t) \in \mathcal{A}$ è legata alla seguente condizione non lineare
        \[
        \beta(t) \geq 0 \iff \kappa \geq \frac{S(t)I(t)}{\beta_0}.
        \]
        </p>
	</section>



	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Honeydew">

	  <h3>Modelli a confronto</h3>

	  <table style="width:65%; font-size:25px;">

      <caption align="top">
          $\kappa$-SIR a sinistra, $\kappa$-SEIR a destra.
      </caption>

	    <tr>
	      <td style="width:50%; border-bottom:0px;">
		<img class="fragment fade-right"
			 src="immagini/ksir/subplot1.svg"
			 alt="modello sir" />
	      </td>

	      <td style="border-bottom:0px;">
		<img class="fragment fade-left"
			 src="immagini/kseir/subplot1.svg"
			 alt="modello sir" />
	      </td>
	    </tr>

	    <tr>
	      <td style="width:50%; border-bottom:0px;">
		<img class="fragment fade-right"
			 src="immagini/ksir/subplot3.svg"
			 alt="modello sir"/>
	      </td>

	      <td style="border-bottom:0px;">
		<img class="fragment fade-left"
			 src="immagini/kseir/subplot3.svg"
			 alt="modello sir" />
	      </td>
	    </tr>

	  </table>

	</section>






	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Azure">
	  <h3>Stima e calibrazione dei parametri</h3>
	  <ul style="font-size:25px; line-height: 40px; ">
        <li class="fragment">stima dei parametri epidemiologici $\beta$ e $\gamma$ nella fase precedente al lockdown;</li>
	    <li class="fragment">stima del parametro di controllo $\kappa$ del modello $\kappa$-SIR.</li>
	  </ul>

     <p style="font-size:20px; text-align:left;"
        class="fragment">
     <img src="immagini/pc.png"
         alt="protezione civile"
         width="42"
         height="42"
         style="vertical-align:middle"> Dati forniti dal <a href="https://github.com/pcm-dpc/COVID-19">Dipartimento della Protezione Civile</a>.
     </p>
	</section>



	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Azure">
	  <h3>Stima e calibrazione dei parametri</h3>
	  
	  <ul style="font-size:25px; line-height: 40px; ">
        <li>stima dei parametri epidemiologici $\beta$ e $\gamma$ nella fase precedente al lockdown;</li>
	  </ul>

        <p style="text-align:left; font-size:25px;">
        \[
        \min_{\beta,\gamma}\;
        \biggl(
        \int_{t_0}^{t_u} \phi\lvert I(t) -\hat{I}(t) \rvert^{2} +
        \psi\lvert R(t) -\hat{R}(t) \rvert^{2} dt
        \biggr)^{1/2}
        \]
        </p>

		
        <p style="text-align:left; font-size:25px;"
           class="fragment">
        sotto i vincoli $\beta \geq 0$ e $\gamma \geq 0$
        </p>


        <p style="text-align:left; font-size:25px;"
           class="fragment">
        con $\phi,\psi \geq 0$&nbsp;&nbsp;tali che&nbsp;&nbsp;$\phi+\psi=1$
        </p>

</section>

    
	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Azure">
	  <h3>Stima e calibrazione dei parametri</h3>
	  
	  <ul style="font-size:25px; line-height: 40px; ">
        <li>stima dei parametri epidemiologici $\beta$ e $\gamma$ nella fase precedente al lockdown;</li>
	  </ul>

        <p style="text-align:left; font-size:25px;">
        \[
        \min_{\beta,\gamma}\;
        \biggl(
        \int_{t_0}^{t_u} \phi\lvert I(t) -\hat{I}(t) \rvert^{2} +
        \psi\lvert R(t) -\hat{R}(t) \rvert^{2} dt
        \biggr)^{1/2}
        \]
        </p>

        <table style="width:65%; font-size:25px;">

        <caption align="bottom">
          <br>
          Utilizzando $\phi=0.5$&nbsp;e&nbsp;$\psi=0.5$.
        </caption>

        <thead>
          <tr>
            <th></th>
            <th>Italia</th>
            <th>Lombardia</th>
            <th>Veneto</th>
            <th>Emilia-Romagna</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>$\beta$</td>
            <td style="text-align:center;">0.3088</td>
            <td style="text-align:center;">0.2923</td>
            <td style="text-align:center;">0.2457</td>
            <td style="text-align:center;">0.3410</td>
          </tr>
          <tr>
            <td>$\gamma$</td>
            <td style="text-align:center;">0.0495</td>
            <td style="text-align:center;">0.0578</td>
            <td style="text-align:center;">0.0165</td>
            <td style="text-align:center;">0.0242</td>
          </tr>
          <tr>
            <td>$\mathcal{R}_0$</td>
            <td style="text-align:center;">6.2352</td>
            <td style="text-align:center;">5.0549</td>
            <td style="text-align:center;">14.8884</td>
            <td style="text-align:center;">14.0619<br></td>
          </tr>
        </tbody>
        </table>

	</section>
	




	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Azure">
	  <h3>Stima e calibrazione dei parametri</h3>
	  
	  <ul style="font-size:25px; line-height: 40px; ">
        <li>stima dei parametri epidemiologici $\beta$ e $\gamma$ nella fase precedente al lockdown;</li>
	  </ul>

        <p style="text-align:left; font-size:25px;">
        \[
        \min_{\beta,\gamma}\;
        \biggl(
        \int_{t_0}^{t_u}
        \phi(t)\lvert I(t) -\hat{I}(t) \rvert^{2} +
        \psi(t)\lvert R(t) -\hat{R}(t) \rvert^{2} dt
        \biggr)^{1/2} - \lambda(\beta,\gamma)
        \]
        </p>


        <p style="text-align:left; font-size:25px;"
        class = "fragment">
        \[
        \phi(t) = a_{\phi} \cdot A \cdot \frac{1}{1+e^{-c (t - t_0)}}, \quad
        \psi(t) = a_{\psi} \cdot A \cdot \frac{1}{1+e^{-c (t - t_0)}}
        \]
        </p>

</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Azure">
	  <h3>Stima e calibrazione dei parametri</h3>
	  
	  <ul style="font-size:25px; line-height: 40px; ">
        <li>stima dei parametri epidemiologici $\beta$ e $\gamma$ nella fase precedente al lockdown;</li>
	  </ul>

        <p style="text-align:left; font-size:25px;">
        \[
        \min_{\beta,\gamma}\;
        \biggl(
        \int_{t_0}^{t_u}
        \phi(t)\lvert I(t) -\hat{I}(t) \rvert^{2} +
        \psi(t)\lvert R(t) -\hat{R}(t) \rvert^{2} dt
        \biggr)^{1/2} - \lambda(\beta,\gamma)
        \]
        </p>

    <table style="width:65%; font-size:25px;">

      <caption align="bottom">
          <br>
          Utilizzando $\lambda(\beta,\gamma) = \nu \cdot \gamma^{1/2}$, con $\nu=0.001$.
      </caption>

        <thead>
          <tr>
            <th></th>
            <th>Italia</th>
            <th>Lombardia</th>
            <th>Veneto</th>
            <th>Emilia-Romagna</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>$\beta$</td>
            <td style="text-align:center;">0.3084</td>
            <td style="text-align:center;">0.2926</td>
            <td style="text-align:center;">0.2446</td>
            <td style="text-align:center;">0.3408</td>
          </tr>
          <tr>
            <td>$\gamma$</td>
            <td style="text-align:center;">0.0498</td>
            <td style="text-align:center;">0.0585</td>
            <td style="text-align:center;">0.0176</td>
            <td style="text-align:center;">0.0253</td>
          </tr>
          <tr>
            <td>$\mathcal{R}_0$</td>
            <td style="text-align:center;">6.1888</td>
            <td style="text-align:center;">4.9984</td>
            <td style="text-align:center;">13.896</td>
            <td style="text-align:center;">13.472<br></td>
          </tr>
        </tbody>
    </table>

	</section>





	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Azure">
	  <h3>Stima e calibrazione dei parametri</h3>
	  <ul style="font-size:25px; line-height: 40px; ">
        <li>stima dei parametri epidemiologici $\beta$ e $\gamma$ nella fase precedente al lockdown;</li>
	  </ul>

	  <img
	  src="immagini/italia/prelock.svg" alt="sim prelock"
	  width="50%"/>
	</section>




	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Azure">
	  <h3>Stima e calibrazione dei parametri</h3>
	  <ul style="font-size:25px; line-height: 40px;">
	    <li style="text-align:left">stima del parametro di controllo $\kappa$ del modello $\kappa$-SIR.</li>
	  </ul>

        <p style="text-align:left; font-size:25px;">
        \[
        \min_{\kappa(t_i)}\;
        \biggl(
        \int_{t_i - k_{l}h}^{t_i + k_{r}h} \phi\lvert I(t) -\hat{I}(t) \rvert^{2} + \psi\lvert R(t) -\hat{R}(t) \rvert^{2} dt
        \biggr)^{1/2}
        \]
        </p>


    <p style="text-align:left; font-size:25px;"
       class="fragment">
       con i vincoli&nbsp;&nbsp;$\kappa(t_i)>0$,&nbsp;&nbsp;$k_l$,&nbsp;$k_r \geq 1$ interi e utilizzando $\beta$ e $\gamma$ ottenuti in precedenza;
    </p>

    <p style="text-align:left; font-size:25px;"
       class="fragment">
       Regressione non lineare con $\kappa(t)=a \cdot e^{-bt} \cdot \big( e^{1-ct} \big)^{3}$.
    </p>

	</section>



	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Azure">
	  <h3>Stima e calibrazione dei parametri</h3>
	  <ul style="font-size:25px; line-height: 40px;">
	    <li>stima del parametro di controllo $\kappa$ del modello $\kappa$-SIR.</li>
	  </ul>

	  <img
	  src="immagini/italia/riep_exp.svg" alt="sim lock"
	  width="50%"/>

	</section>




	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Azure">
	  <h3>Confronto SIR e SEIR</h3>

	      <table style="width:60%; font-size:25px;"
	      class="fragment fade-up">


      <caption align="bottom">
          <br>
          Utilizzando $\lambda(\beta,\gamma) =  \nu \cdot (\beta^2 + \mu^2)$, con $\nu=1$.
      </caption>

        <thead>
          <tr>
            <th></th>
            <th style="text-align:center;">$\beta$</th>
            <th style="text-align:center;">$\gamma$</th>
            <th style="text-align:center;">$\mu$</th>
            <th style="text-align:center;">$\mathcal{R}_0$</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Italia</td>
            <td style="text-align:center;">0.4377</td>
            <td style="text-align:center;">0.0807</td>
            <td style="text-align:center;">0.3500</td>
            <td style="text-align:center;">5.4257</td>
          </tr>
        </tbody>
    </table>

	</section>





	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Azure">
	  <h3>Confronto SIR e SEIR</h3>

	  <table style="width:100%; font-size:25px;">

      <caption align="top">
          $\kappa$-SIR a sinistra, $\kappa$-SEIR a destra.
      </caption>

	    <tr>
	      <td style="width:50%; border-bottom:0px;">
		<img class="fragment fade-right"
			 src="immagini/italia/riep_exp.svg"
			 alt="riepilogo sir exp" />
	      </td>

	      <td style="border-bottom:0px;">
		<img class="fragment fade-left"
			 src="immagini/kseir/riep_exp.svg"
			 alt="riepilogo seir exp" />
	      </td>
	    </tr>

	  </table>

	</section>



	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Azure">
	  <h3>Stima dell'andamento effettivo di infezione con dati incerti</h3>
	</section>




	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Azure">
	  <h3>Stima dell'andamento effettivo di infezione con dati incerti</h3>

        <p style="text-align:left; font-size:25px;">
    Consideriamo la variabile casuale $\boldsymbol{z}=(z_{1}, z_{2})$ con componenti indipendenti tale che
        \[
	    I(\boldsymbol{z},0) = I_0(1 + \mu z_{1}), \quad
        R(\boldsymbol{z},0) = R_0(1 + \mu z_{1}),
        \]
        \[
        \beta(\boldsymbol{z}) = \beta_{e} + \alpha_{\beta} z_{2}, \quad
        \gamma(\boldsymbol{z}) = \gamma_{e} + \alpha_{\gamma} z_{2}.
        \]
    </p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Azure">
	  <h3>Stima dell'andamento effettivo di infezione con dati incerti</h3>
    <p style="text-align:left; font-size:25px; line-height: 50px;">
    \[
    \left\{
    \begin{aligned}
        \dot{S}(\boldsymbol{z},t) & =
        -\biggl(
        \beta_0 -\frac{S_{r}(t) I_{r}(t)}{\kappa(t)}
        \biggr) S(\boldsymbol{z},t)
        I(\boldsymbol{z},t) \\[2pt]
        \dot{I}(\boldsymbol{z},t) & =
        \biggl(
        \beta_0 - \frac{S_{r}(t) I_{r}(t)}{\kappa(t)}
        \biggr) S(\boldsymbol{z},t)I(\boldsymbol{z},t)
        - \gamma I(\boldsymbol{z},t)
    \end{aligned}
    \right.
    \]
    </p>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="Azure">
	  <h3>Stima dell'andamento effettivo di infezione con dati incerti</h3>

	  <table style="width:100%; font-size:20px;">

      <caption align="top">
          Casi attuali attesi a sinistra, casi totali attesi a destra.<br>
          Simulazione con $z_1 \sim B(2,2),&nbsp;&nbsp;z_2 \sim B(10,10),&nbsp;&nbsp; \alpha_{\beta}=0.05$ e $\alpha_{\gamma}=0$.
      </caption>

	    <tr>
	      <td style="width:50%; border-bottom:0px;">
		<img class="fragment fade-right"
			 src="immagini/italia/riepilogoStat Jun 30.svg"
			 alt="casi attuali attesi" />
	      </td>

	      <td style="border-bottom:0px;">
		<img class="fragment fade-left"
			 src="immagini/italia/CTriepilogoStat Jun 30.svg"
			 alt="casi totali attesi" />
	      </td>
	    </tr>

	  </table>

	</section>





	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="AliceBlue">
	  <h3>Conclusioni e sviluppi futuri</h3>

    <p style="text-align:left; font-size:25px;">
        Gli obiettivi di questo studio sono stati:
    </p>

	  <ul style="font-size:25px; line-height: 40px;">
	    <li class="fragment">lo sviluppo di un modello compartimentale con controllo feedback per lo studio della diffusione dell'epidemia COVID-19 in Italia;</li>
	    <li class="fragment">l'analisi del problema relativo all'affidabilità dei dati disponibili.</li>
	  </ul>
	</section>


	<section data-auto-animate data-auto-animate-unmatched="fade"
	data-background="AliceBlue">
	  <h3>Conclusioni e sviluppi futuri</h3>
        <p style="text-align:left; font-size:25px;">
	  Gli sviluppi immediati di questo lavoro possono riguardare:
    </p>
    
	  <ul style="font-size:25px; line-height: 40px;">
	    <li class="fragment">la modelizzazione del parametro $\beta$;</li>
	    <li class="fragment">l'introduzione di stocasticità;</li>
	    <li class="fragment">l'inclusione dei casi asintomatici.</li>
	  </ul>

	</section>




			</div>
		</div>

		<script src="dist/reveal.js"></script>
	<!--	<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
-->
    <script src="plugin/math/math.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,
	  transition: "fade",
	  math: {

          //mathjax: 'https://cdn.jsdelivr.net/gh/mathjax/mathjax@2.7.8/MathJax.js',
	      mathjax: 'mathjax/MathJax.js',
	      config: 'TeX-AMS_HTML-full',
	      TeX: {
		  Macros: {
		      R: '\\mathbb{R}',
		      set: [ '\\left\\{#1 \\; ; \\; #2\\right\\}', 2 ]
		  }
	      }
	  },
				// Learn about plugins: https://revealjs.com/plugins/
    	plugins: [ RevealMath ]
			});
		</script>
	</body>
</html>
